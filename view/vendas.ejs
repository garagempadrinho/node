<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>Vendas</title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <h1>💰 Lista de Vendas</h1>
    <nav>
        <a href="/">🚗 Carros</a> |
        <a href="/clientes">👥 Clientes</a> |
        <a href="/vendas">💰 Vendas</a>
    </nav>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Cliente</th>
                <th>Valor da Venda</th>
                <th>Desconto</th>
                <th>Valor Final</th>
            </tr>
        </thead>
        <tbody>
            <% vendas.forEach(venda=> { %>
                <tr>
                    <td>
                        <%= venda.id_venda %>
                    </td>
                    <td>
                        <%= venda.nome %>
                    </td>
                    <td>
                        <%= new Intl.NumberFormat('pt-BR', { style: 'currency' , currency: 'BRL'
                            }).format(Number(venda.valor_venda)) %>
                    </td>
                    <td>
                        <%= new Intl.NumberFormat('pt-BR', { style: 'currency' , currency: 'BRL'
                            }).format(Number(venda.desconto)) %>
                    </td>
                    <td>
                        <%= new Intl.NumberFormat('pt-BR', { style: 'currency' , currency: 'BRL'
                            }).format(Number(venda.valor_venda) - Number(venda.desconto)) %>
                    </td>
                    <td>
                        <a href="/vendas/editar/<%= venda.id_venda %>">✏️ Editar</a>
                        <a href="/vendas/deletar/<%= venda.id_venda %>"
                            onclick="return confirm('Tem certeza que deseja excluir esta venda?')">🗑️ Deletar</a>
                    </td>
                </tr>
                <% }) %>
        </tbody>
    </table>
    <h2>Registrar Venda</h2>
    <form action="/vendas/add" method="POST">
        <label>Cliente:</label>
        <select name="id_cliente" required>
            <% clientes.forEach(cliente=> { %>
                <option value="<%= cliente.id_cliente %>">
                    <%= cliente.nome %>
                </option>
                <% }) %>
        </select>

        <label>Valor da Venda:</label>
        <input type="number" step="0.01" name="valor_venda" required>

        <label>Desconto:</label>
        <input type="number" step="0.01" name="desconto" required>

        <button type="submit">Registrar Venda</button>
    </form>

</body>

</html>
